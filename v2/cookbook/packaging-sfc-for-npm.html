



<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Réaliser un composant Vue pour npm — Vue.js</title>
    <meta charset="utf-8">
    <meta name="description" content="Vue.js - Le Framework JavaScript Évolutif">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="alternate" hreflang="x-default" href="https://vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="zh" href="https://cn.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="ja" href="https://jp.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="ru" href="https://ru.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="ko" href="https://kr.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="pt-BR" href="https://br.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="fr" href="https://fr.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">
    <link rel="alternate" hreflang="es" href="https://es.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Réaliser un composant Vue pour npm — Vue.js">
    <meta property="og:description" content="Vue.js - Le Framework JavaScript Évolutif">
    <meta property="og:image" content="https://vuejs.org//images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Réaliser un composant Vue pour npm — Vue.js">
    <meta name="twitter:description" content="Vue.js - Le Framework JavaScript Évolutif">
    <meta name="twitter:image" content="https://vuejs.org/images/logo.png">

    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
    <meta name="msapplication-TileImage" content="/images/icons/ms-icon-144x144.png">
    <link rel="icon" href="/images/logo.png" type="image/png">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href="https://fonts.googleapis.com" rel="preconnect" crossorigin>
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://maxcdn.bootstrapcdn.com" rel="preconnect" crossorigin>

    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:500&text=Vue.js&display=swap" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script src="/js/vue.js"></script>

    

    <script>
      Vue.config.productionTip = false
      window.PAGE_TYPE = "cookbook"
    </script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46852172-1', 'vuejs.org');
      ga('send', 'pageview');
    </script>

    <!-- vimeo analytics -->
    <script type="text/javascript" defer="defer" src="https://extend.vimeocdn.com/ga/72160148.js"></script>
  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div>
  
  <a id="bts" class="bts-hidden" href="https://vueschool.io/sales/back-to-school?friend=vuejs" target="_blank" rel="noreferrer">
    <div class="bts-logo">
      <img src="/images/banners/bts-logo.svg">
    </div>
    <div class="bts-main">
      <div class="bts-backpack">
        <img src="/images/banners/bts-backpack.svg">
      </div>
      <div class="bts-slogan">
        <div class="bts-title">
          Moins de <span class="bts-title-green">48 heures</span> restante pour notre offre Vue School
        </div>
      </div>
      <div>
        <div class="bts-button">REJOINDRE</div>
      </div>
    </div>
    <div id="bts-close" class="bts-close">
      &times;
    </div>
  </a>
  

  <header id="header">
    <a id="logo" href="/">
      <img src="/images/logo.png" alt="vue logo">
      <span>Vue.js</span>
    </a>
    <ul id="nav">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input" aria-label="Search">
  </form>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Doc</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Documentations</h4></li>
    <li>
      <ul>
        <li><a href="/v2/guide/" class="nav-link">Guide</a></li>
        <li><a href="/v2/api/" class="nav-link">API</a></li>
        <li><a href="/v2/style-guide/" class="nav-link">Conventions</a></li>
        <li><a href="/v2/examples/" class="nav-link">Exemples</a></li>
        <li><a href="/v2/cookbook/" class="nav-link current">Tutoriels</a></li>
      </ul>
    </li>
    <li><h4>Videos</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery (EN)
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School (EN)
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Écosystème</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Aide</h4></li>
    <li><ul>
      <li><a href="https://forum.vuejs.org/c/french" class="nav-link" target="_blank" rel="noopener">Forum</a></li>
      <li><a href="https://discordapp.com/channels/325477692906536972/360669119948783616" class="nav-link" target="_blank" rel="noopener">Chat</a></li>
      <li><a href="https://events.vuejs.org/meetups/" class="nav-link" target="_blank" rel="noopener">Meetups (EN)</a></li>
    </ul></li>
    <li><h4>Outils</h4></li>
    <li>
      <ul>
        <li><a href="https://github.com/vuejs/vue-devtools" class="nav-link" target="_blank" rel="noopener">Devtools (EN)</a></li>
        <li><a href="https://cli.vuejs.org/" class="nav-link" target="_blank" rel="noopener">Vue CLI (EN)</a></li>
        <li><a href="https://vue-loader.vuejs.org" class="nav-link" target="_blank" rel="noopener">Vue Loader (EN)</a></li>
      </ul>
    </li>
    <li><h4>Bibliothèques officielles</h4></li>
    <li><ul>
      <li><a href="https://router.vuejs.org/" class="nav-link" target="_blank" rel="noopener">Vue Router</a></li>
      <li><a href="https://vuex.vuejs.org/" class="nav-link" target="_blank" rel="noopener">Vuex</a></li>
      <li><a href="https://ssr.vuejs.org/" class="nav-link" target="_blank" rel="noopener">Vue Server Renderer</a></li>
    </ul></li>
    <li><h4>Infos</h4></li>
    <li><ul>
      <li><a href="https://news.vuejs.org" class="nav-link" target="_blank" rel="noopener">Actualités (EN)</a></li>
      <li><a href="https://github.com/vuejs/vue/projects/6" class="nav-link" target="_blank" rel="noopener">Plans futurs (EN)</a></li>
      <li><a href="https://events.vuejs.org/" class="nav-link" target="_blank" rel="noopener">Évènements (EN)</a></li>
      <li><a href="https://twitter.com/vuejs" class="nav-link" target="_blank" rel="noopener">Twitter (EN)</a></li>
      <li><a href="https://medium.com/the-vue-point" class="nav-link" target="_blank" rel="noopener">Blog (EN)</a></li>
      <li><a href="https://vuejobs.com/?ref=vuejs" class="nav-link" target="_blank" rel="noopener">Offres d'emploi (EN)</a></li>
      <li><a href="https://dev.to/t/vue" class="nav-link" target="_blank" rel="noopener">Communauté DEV (EN)</a></li>
    </ul></li>
  </ul>
</li>

<li>
  <a href="/v2/guide/team.html" class="nav-link team">Équipe</a>
</li>
<li class="nav-dropdown-container resources">
  <a href="#" class="nav-link">Resources</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/resources/partners.html" class="nav-link">Partenaires</a></li>
    <li><a href="/resources/themes.html" class="nav-link">Thèmes</a></li>
    <li><a href="https://github.com/vuejs/awesome-vue" class="nav-link" target="_blank">Awesome Vue (EN)</a></li>
    <li><a href="https://awesomejs.dev/for/vue/" class="nav-link" target="_blank" rel="noopener">Packages pour Vue (EN)</a></li>
  </ul>
</li>

<!-- <li>
  <a href="/partners" class="nav-link ">Partners</a>
</li> -->
<li class="nav-dropdown-container support-vue">
  <a href="/support-vuejs/" class="nav-link">Soutien</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/support-vuejs/#One-time-Donations" class="nav-link">Dons ponctuel</a></li>
    <li><a href="/support-vuejs/#Recurring-Pledges" class="nav-link">Soutiens récurrent</a></li>
    <li><a href="https://vue.threadless.com" target="_blank" rel="noopener" class="nav-link">La boutique</a></li>
  </ul>
</li>

<li class="nav-dropdown-container language">
  <a class="nav-link">Langues</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://cn.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">中文</a></li>
    <li><a href="https://jp.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">日本語</a></li>
    <li><a href="https://ru.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Русский</a></li>
    <li><a href="https://kr.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">한국어</a></li>
    <li><a href="https://vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">English</a></li>
    <li><a href="https://br.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Português</a></li>
    <li><a href="https://fr.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Français</a></li>
    <li><a href="https://vi.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Tiếng Việt</a></li>
    <li><a href="https://es.vuejs.org/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Español</a></li>
    <li><a href="https://docs.vuejs.id/v2/cookbook/packaging-sfc-for-npm.html" class="nav-link">Bahasa Indonesia</a></li>
  </ul>
</li>


    </ul>
  </header>
</div>

    
      <div id="main" class="fix-sidebar">
        
  

<div class="sidebar">
  <div class="sidebar-inner">
    
    <div class="list">
      <div id="sidebar-sponsors-special">
  <div class="main-sponsor">
    <span>Special Sponsor</span>
    <div>
    <a href="https://autocode.com/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/autocode.svg" alt="Autocode">
    </a>
    </div>
  </div>
</div>

<div id="sidebar-sponsors-platinum-left">
  <div class="main-sponsor">
    <span>Sponsors de platine</span>
    <div>
    <a href="https://vueschool.io/?utm_source=Vuejs.org&utm_medium=Banner&utm_campaign=Sponsored%20Banner&utm_content=V1" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vueschool.png" alt="VueSchool">
    </a>
    <a href="https://vehikl.com/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vehikl.png" alt="Vehikl">
    </a>
    <a href="https://retool.com/?utm_source=sponsor&utm_campaign=vue" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/retool.png" alt="Retool">
    </a>
    <a href="https://passionatepeople.io/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/passionate_people.png" alt="Passionate People">
    </a>
    <a href="https://www.storyblok.com" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/storyblok.png" alt="Storyblok">
    </a>
    </div>
  </div>
  <a class="become-backer" href="/support-vuejs">
    Devenez un sponsor
  </a>
</div>



      
        <h2>
          
          Tutoriels<sup class="beta">beta</sup>
          
        </h2>
        <ul class="menu-root">
  
    
    
    <li>
      <a href="/v2/cookbook/index.html" class="sidebar-link">Introduction</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/adding-instance-properties.html" class="sidebar-link">Ajouter des propriétés aux instances</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/form-validation.html" class="sidebar-link">Form Validation</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/editable-svg-icons.html" class="sidebar-link">Système d'Icônes SVG Dynamiques</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/serverless-blog.html" class="sidebar-link">Créer un blog alimenté par un CMS</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/unit-testing-vue-components.html" class="sidebar-link">Test Unitaire des Composants Vue</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/creating-custom-scroll-directives.html" class="sidebar-link">Créer une directive de défilement personnalisée</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/debugging-in-vscode.html" class="sidebar-link">Déboguer dans VS Code</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/using-axios-to-consume-apis.html" class="sidebar-link">Utiliser Axios pour consommer des API</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/avoiding-memory-leaks.html" class="sidebar-link">Éviter les fuites de mémoire</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/client-side-storage.html" class="sidebar-link">Stockage côté client</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/packaging-sfc-for-npm.html" class="sidebar-link current">Réaliser un composant Vue pour npm</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/dockerize-vuejs-app.html" class="sidebar-link">Dockeriser une app Vue.js</a>
    </li>
  
    
    
    <li>
      <a href="/v2/cookbook/practical-use-of-scoped-slots.html" class="sidebar-link">Practical use of scoped slots with GoogleMaps (EN)</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>

<div id="sidebar-sponsors-platinum-right">
  <div class="main-sponsor">
    <span>Sponsors de platine</span>
    <div>
    <a href="https://vueschool.io/?utm_source=Vuejs.org&utm_medium=Banner&utm_campaign=Sponsored%20Banner&utm_content=V1" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vueschool.png" alt="VueSchool">
    </a>
    <a href="https://vehikl.com/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vehikl.png" alt="Vehikl">
    </a>
    <a href="https://retool.com/?utm_source=sponsor&utm_campaign=vue" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/retool.png" alt="Retool">
    </a>
    <a href="https://passionatepeople.io/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/passionate_people.png" alt="Passionate People">
    </a>
    <a href="https://www.storyblok.com" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/storyblok.png" alt="Storyblok">
    </a>
    </div>
  </div>
  <a class="become-backer" href="/support-vuejs">
    Devenez un sponsor
  </a>
</div>




<div class="content cookbook with-sidebar ">
  
    
      
<div id="ad">
  <script
    async
    type="text/javascript"
    src="//cdn.carbonads.com/carbon.js?serve=CEBDT27Y&placement=vuejsorg"
    id="_carbonads_js">
  </script>
</div>


    
  
  
    <h1>Réaliser un composant Vue pour npm</h1>
  
  
    <h2 id="Exemple-de-base"><a href="#Exemple-de-base" class="headerlink" title="Exemple de base"></a>Exemple de base</h2><p>Par nature, un composant Vue est destiné à être réutilisé. Cela est facile lorsque le composant n’est utilisé que dans une seule application. Mais comment peut-on écrire un composant une seule fois et l’utiliser sur plusieurs sites/applications ? La solution la plus simple est peut-être de passer par npm.</p>
<p>En empaquetant votre composant afin qu’il soit partagé via npm, il peut être importé dans un processus de construction pour être utilisé dans des applications web à part entière :</p>
<pre><code class="hljs js"><span class="hljs-keyword">import</span> MyComponent <span class="hljs-keyword">from</span> <span class="hljs-string">'my-component'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;
  <span class="hljs-attr">components</span>: &#123;
    MyComponent,
  &#125;,
    <span class="hljs-comment">// ... suite du composant</span>
&#125;</code></pre>
<p>Ou même utilisé via la balise <code>&lt;script&gt;</code> dans le navigateur directement :</p>
<pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/vue"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/my-component"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
...
<span class="hljs-tag">&lt;<span class="hljs-name">my-component</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-component</span>&gt;</span>
...</code></pre>
<p>Non seulement cela vous évite de copier/coller des composants, mais cela vous permet aussi de les partager avec la communauté Vue ! </p>
<h2 id="Puis-je-partager-directement-les-fichiers-vue"><a href="#Puis-je-partager-directement-les-fichiers-vue" class="headerlink" title="Puis-je partager directement les fichiers .vue ?"></a>Puis-je partager directement les fichiers <code>.vue</code> ?</h2><p>Vue autorise déjà l’écriture des composants dans un fichier unique. Du fait qu’un (<a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> soit déjà un fichier unique, vous pourriez donc vous poser la question suivante :</p>
<blockquote>
<p>Pourquoi les gens ne peuvent-ils pas utiliser mon fichier <code>.vue</code> directement ? N’est-ce pas la façon la plus simple de partager des composants ?</p>
</blockquote>
<p>C’est vrai, vous pouvez partager vos fichiers <code>.vue</code> directement, et n’importe qui utilisant <a href="https://fr.vuejs.org/v2/guide/installation.html#Explication-des-differents-builds">Un build Vue</a> contenant le compilateur Vue peut utiliser votre composant directement. Aussi, les builds déstinés aux applications SSR utilisent la concaténation de chaînes de caractères comme une optimisation, l’utilisation de composants <code>.vue</code> partagés directement est donc préférable dans cette situation (lire la section <a href="#Rendu-cote-serveur">Rendu côté serveur</a> pour plus de détails). Cependant, cela exclut les personnes souhaitant utiliser le composant directement dans un navigateur via la balise <code>&lt;script&gt;</code>, mais aussi les personnes souhaitant utiliser une compilation à l’exécution ou encore une application contenant des processus de compilation incapables de lire des fichiers <code>.vue</code>.</p>
<p>Un package approprié de votre <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> pour une distribution via npm permet de le partager de manière à ce qu’il soit prêt à être utilisé partout !</p>
<h2 id="Realiser-un-package-de-votre-composant-pour-npm"><a href="#Realiser-un-package-de-votre-composant-pour-npm" class="headerlink" title="Réaliser un package de votre composant pour npm"></a>Réaliser un package de votre composant pour npm</h2><p>Pour les besoins de ce document, nous allons utiliser la structure suivante :</p>
<pre><code class="hljs undefined">package.json
build/
   rollup.config.js
src/
   wrapper.js
   my-component.vue
dist/</code></pre>
<p class="tip">Tout au long de ce document, il est fait référence au fichier package.json mentionné dans la structure présente ci-dessus. Le fichier utilisé dans ces exemples a été généré à la main, et contiendra la configuration minimale requise pour la tâche en question. Il est probable que votre fichier package.json contienne beaucoup plus d’éléments que ce qui est énuméré sur ce document.</p>

<h3 id="Comment-npm-sait-il-quelle-version-servir"><a href="#Comment-npm-sait-il-quelle-version-servir" class="headerlink" title="Comment npm sait-il quelle version servir ?"></a>Comment npm sait-il quelle version servir ?</h3><p>Le fichier package.json utilisé sur npm nécessite qu’une seule version (<code>main</code>), mais nous ne sommes pas seulement limité à cela. Nous pouvons aussi traiter les cas d’utilisation les plus courants en précisant 2 versions supplémentaires (<code>module</code> et <code>unpkg</code>) et même fournir un accès au fichier <code>.vue</code> lui-même en utilisant le champ <code>browser</code>. Notre fichier package.json devrait donc, pour l’instant, ressembler à ceci :</p>
<pre><code class="hljs json">&#123;
  "name": "my-component",
  "version": "1.2.3",
  "main": "dist/my-component.umd.js",
  "module": "dist/my-component.esm.js",
  "unpkg": "dist/my-component.min.js",
  "browser": &#123;
    "./sfc": "src/my-component.vue"
  &#125;,
  ...
&#125;</code></pre>
<p>Quand webpack 2+, Rollup ou bien d’autres outils de compilation sont utilisés, ils reprennent la construction du build de type <code>module</code>. Les anciennes applications utiliseraient donc la version <code>main</code> tandis que la version <code>unpkg</code> peut être utilisée directement dans les navigateurs. Par ailleurs, <a href="https://unpkg.com" target="_blank" rel="noopener">unpkg</a> utilise automatiquement la version <code>unpkg</code> lorsque quelqu’un saisit l’URL de votre module dans son service !</p>
<h3 id="Rendu-cote-serveur-SSR"><a href="#Rendu-cote-serveur-SSR" class="headerlink" title="Rendu côté serveur (SSR)"></a>Rendu côté serveur (SSR)</h3><p>Vous aurez peut-être remarqué que les navigateurs n’utilisent pas la version <code>browser</code>. C’est parce que ce champ est destiné pour que l’auteur du package fournisse <a href="https://github.com/defunctzombie/package-browser-field-spec#spec" target="_blank" rel="noopener">quelque chose aux bundlers</a> qui, à leur tour, créent leurs propres paquets pour une utilisation côté client. Avec un peu d’imagination ce champ nous permet de faire correspondre un alias au fichier <code>.vue</code> lui-même. Par exemple :</p>
<pre><code class="hljs js"><span class="hljs-keyword">import</span> MyComponent <span class="hljs-keyword">from</span> <span class="hljs-string">'my-component/sfc'</span>; <span class="hljs-comment">// Notons le '/sfc'</span></code></pre>
<p>Les bundlers compatibles peuvent lire l’option <code>browser</code> dans le fichier package.json et traduire les requêtes de <code>my-component/sfc</code> en <code>my-component/src/my-component.vue</code>, ce qui permet d’utiliser le fichier <code>.vue</code> original à la place. Maintenant, le processus SSR peut utiliser les optimisations de concaténation de chaînes de caractères dont il a besoin pour un gain de performances.</p>
<p class="tip">Note: Lorsque vous utilisez un fichier <code>.vue</code> directement, faites attention à tout type de prétraitement sur les balises <code>script</code> et <code>style</code>. Ces dépendances seront transmises aux utilisateurs. Envisagez donc de fournir des <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> « simples » pour alléger au maximum les choses.</p>

<h3 id="Comment-puis-je-realiser-plusieurs-versions-de-mon-composant"><a href="#Comment-puis-je-realiser-plusieurs-versions-de-mon-composant" class="headerlink" title="Comment puis-je réaliser plusieurs versions de mon composant ?"></a>Comment puis-je réaliser plusieurs versions de mon composant ?</h3><p>Vous n’avez pas besoin de réecrire votre module plusieurs fois car il est tout à fait possible de préparer 3 versions de votre module en une seule étape, en quelques secondes seulement. L’exemple ci-dessous utilise <a href="https://rollupjs.org" target="_blank" rel="noopener">Rollup</a> en raison de sa configuration minimaliste, mais une configuration similaire est possible avec d’autres outils de builds (plus de détails sur <a href="https://medium.com/webpack/webpack-and-rollup-the-same-but-different-a41ad427058c" target="_blank" rel="noopener">ce post (EN)</a>). La section <code>scripts</code> de notre package.json peut être mise à jour avec une seule entrée pour chaque cible de compilation, et un script <code>build</code> plus générique qui les exécute tous en un seul passage. Notre fichier package.json ressemble désormais à ceci :</p>
<pre><code class="hljs json">&#123;
  "name": "my-component",
  "version": "1.2.3",
  "main": "dist/my-component.umd.js",
  "module": "dist/my-component.esm.js",
  "unpkg": "dist/my-component.min.js",
  "browser": &#123;
    "./sfc": "src/my-component.vue"
  &#125;,
  "scripts": &#123;
    "build": "npm run build:umd &amp; npm run build:es &amp; npm run build:unpkg",
    "build:umd": "rollup --config build/rollup.config.js --format umd --file dist/my-component.umd.js",
    "build:es": "rollup --config build/rollup.config.js --format es --file dist/my-component.esm.js",
    "build:unpkg": "rollup --config build/rollup.config.js --format iife --file dist/my-component.min.js"
  &#125;,
  "devDependencies": &#123;
    "rollup": "^1.17.0",
    "@rollup/plugin-buble": "^0.21.3",
    "@rollup/plugin-commonjs": "^11.1.0",
    "rollup-plugin-vue": "^5.0.1",
    "vue": "^2.6.10",
    "vue-template-compiler": "^2.6.10"
    ...
  &#125;,
  ...
&#125;</code></pre>
<p class="tip">N’oubliez pas que si un fichier package.json est déjà présent sur votre projet, il sera probablement beaucoup plus long que celui présenté ici. Ceci n’illustre qu’un point de départ. De plus, les <em>paquets</em> listés dans devDependencies (et non leurs versions) sont les exigences minimales pour que Rollup puisse créer les trois builds séparées (umd, es, et unpkg). Au fur et à mesure que des versions plus récentes sont disponibles, elles doivent être mises à jour si nécessaire.</p>

<p>Nos chamgements effectués sur notre package.json sont désormais terminés. Ensuite, nous aurons besoin d’un petit fichier pour exporter/installer automatiquement le (<a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> actuel, d’une configuration minimale de Rollup, et c’est parti !</p>
<h3 id="A-quoi-va-ressembler-mon-composant"><a href="#A-quoi-va-ressembler-mon-composant" class="headerlink" title="À quoi va ressembler mon composant ?"></a>À quoi va ressembler mon composant ?</h3><p>En fonction de la manière dont votre composant est utilisé, il doit être exposé soit comme un module JavaScript (<a href="https://medium.freecodecamp.org/javascript-modules-a-beginner-s-guide-783f7d7a5fcc#c33a" target="_blank" rel="noopener">CommonJS/UMD</a>), un module <a href="https://medium.freecodecamp.org/javascript-modules-a-beginner-s-guide-783f7d7a5fcc#4f5e" target="_blank" rel="noopener">ES6</a> ou bien dans le cas d’une utilisation via <code>script</code>, ce composant sera automatiquement chargé dans Vue via <code>Vue.use(...)</code> et donc directement disponible. Ce fichier wrapper.js qui gère l’exportation et l’installation automatique du module ressemble à ceci:</p>
<pre><code class="hljs js"><span class="hljs-comment">// Importation de notre composant Vue</span>
<span class="hljs-keyword">import</span> component <span class="hljs-keyword">from</span> <span class="hljs-string">'./my-component.vue'</span>;

<span class="hljs-comment">// Déclaration de la méthode d'installation utilisée via Vue.use(...)</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">install</span>(<span class="hljs-params">Vue</span>) </span>&#123;
	<span class="hljs-keyword">if</span> (install.installed) <span class="hljs-keyword">return</span>;
  
	install.installed = <span class="hljs-literal">true</span>;
  
	Vue.component(<span class="hljs-string">'MyComponent'</span>, component);
&#125;

<span class="hljs-comment">// Création du module à destionation Vue.use(...)</span>
<span class="hljs-keyword">const</span> plugin = &#123;
	install,
&#125;;

<span class="hljs-comment">// Installation automatique si Vue est détecté (par exemple dans un navigation via la balise &lt;script&gt;)</span>
<span class="hljs-keyword">let</span> GlobalVue = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span>) &#123;
	GlobalVue = <span class="hljs-built_in">window</span>.Vue;
&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> global !== <span class="hljs-string">'undefined'</span>) &#123;
	GlobalVue = global.Vue;
&#125;

<span class="hljs-keyword">if</span> (GlobalVue) &#123;
	GlobalVue.use(plugin);
&#125;

<span class="hljs-comment">// Exporter en tant que module (pour npm/webpack/etc.)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> component;</code></pre>
<p>On peut remarquer que la première ligne importe directement notre <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> et que la dernière ligne l’exporte tel quel. Comme indiqué dans les commentaires, ce fichier de configuration fourni une méthode “d’installation” déstinée à Vue puis tente de détecter Vue afin de s’installer automatiquement. Avec 90% du travail effectué, il est temps de sprinter jusqu’à l’arrivée !</p>
<h3 id="Comment-configurer-un-build-avec-Rollup"><a href="#Comment-configurer-un-build-avec-Rollup" class="headerlink" title="Comment configurer un build avec Rollup ?"></a>Comment configurer un build avec Rollup ?</h3><p>Avec notre package.json contenant la section <code>scripts</code> prête à démarrer et la configuration de notre <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> mise en place via notre wrapper, il ne reste plus qu’à s’assurer que Rollup est correctement configuré. Heureusement, cela peut être fait avec un petit fichier rollup.config.js de 19 lignes déjà prêt :</p>
<pre><code class="hljs js"><span class="hljs-keyword">import</span> commonjs <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-commonjs'</span>; <span class="hljs-comment">// Converti les modules CommonJS en ES6</span>
<span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-vue'</span>; <span class="hljs-comment">// Gère les composants .vue</span>
<span class="hljs-keyword">import</span> buble <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-buble'</span>; <span class="hljs-comment">// Permet un polyfill de notre code pour un meilleur support sur les navigateurs</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;
  <span class="hljs-attr">input</span>: <span class="hljs-string">'src/wrapper.js'</span>, <span class="hljs-comment">// Fichier relatif en partant de notre fichier package.json</span>
  output: &#123;
    <span class="hljs-attr">name</span>: <span class="hljs-string">'MyComponent'</span>,
    <span class="hljs-attr">exports</span>: <span class="hljs-string">'named'</span>,
  &#125;,
  <span class="hljs-attr">plugins</span>: [
    commonjs(),
    vue(&#123;
      <span class="hljs-attr">css</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Injecte dynamiquement notre CSS dans une balise &lt;style&gt;</span>
      compileTemplate: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Converti notre template en fonction de rendu Vue</span>
    &#125;),
    buble(), <span class="hljs-comment">// Traduit en ES5</span>
  ],
&#125;;</code></pre>
<p>Cet exemple de configuration contient les paramètres minimums pour empaqueter votre <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> à destination de npm. Il est possible de le personnaliser, par exemple en extrayant le CSS dans un fichier séparé, en utilisant un préprocesseur CSS, en masquant la sortie JS, etc.</p>
<p>Il convient également de noter le « nom » donné au composant ici qui est en PascalCase, et qui devrait correspondre au nom en kebab-case utilisé ailleurs dans ce projet.</p>
<h3 id="Cela-remplacera-t-il-mon-processus-de-developpement-actuel"><a href="#Cela-remplacera-t-il-mon-processus-de-developpement-actuel" class="headerlink" title="Cela remplacera-t-il mon processus de développement actuel ?"></a>Cela remplacera-t-il mon processus de développement actuel ?</h3><p>La configuration ici n’est pas destinée à remplacer le processus de développement que vous utilisez actuellement. Si, actuellement, vous avez une configuration webpack avec hot-reload, continuez à l’utiliser ! Si vous partez de zéro, n’hésitez pas à installer <a href="https://github.com/vuejs/vue-cli/" target="_blank" rel="noopener">Vue CLI 3</a>, qui vous donnera la configuration complète d’un hot-reload avec la commande suivante :</p>
<pre><code class="hljs bash">vue serve --open src/my-component.vue</code></pre>
<p>En d’autres termes, développez de la manière qui vous convient le mieux. Les éléments décrits sur cette page ressemblent plus à des « touches finales » qu’à un processus de développement complet.</p>
<h2 id="Quand-eviter-ce-schema"><a href="#Quand-eviter-ce-schema" class="headerlink" title="Quand éviter ce schéma ?"></a>Quand éviter ce schéma ?</h2><p>Conditionner les <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> de cette manière n’est pas forcément une bonne idée dans certains cas. Cette page n’entre pas dans le détail de la manière dont les composants eux-mêmes sont écrits. Certains composants peuvent avoir des effets secondaires comme des directives, ou étendre d’autres bibliothèques avec des fonctionnalités supplémentaires. Dans ces cas, vous devrez évaluer si les changements nécessaires décrits sur cette page sont trop importants ou non.</p>
<p>En outre, faites attention à toute dépendance supplémentaire que votre <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> pourrait avoir. Par exemple, si vous avez besoin d’une bibliothèque tierce pour le tri ou la communication avec une API, Rollup peut ommetre ces différents packages dans le code final s’il n’est pas correctement configuré. Pour continuer à utiliser ceci, vous devrez configurer Rollup et exclure ces fichiers de la sortie puis mettre à jour votre documentation pour informer vos utilisateurs de la présence ces dépendances.</p>
<h2 id="Patterns-alternatifs"><a href="#Patterns-alternatifs" class="headerlink" title="Patterns alternatifs"></a>Patterns alternatifs</h2><p>Au moment où cette recette est écrite, Vue CLI 3 est elle-même en version bêta. Cette version de la CLI est dotée d’un mode de construction <code>library</code> intégré, qui crée des versions CommonJS et UMD d’un composant. Cela peut être adéquat pour vos cas d’utilisation, mais vous devrez quand même vous assurer que votre fichier package.json pointe correctement vers <code>main</code> and <code>unpkg</code>. De plus, il n’y aura pas de sortie de <code>module</code> ES6 à moins que cette fonctionnalité ne soit ajoutée au CLI avant sa sortie ou via un plugin.</p>
<h2 id="Remerciements"><a href="#Remerciements" class="headerlink" title="Remerciements"></a>Remerciements</h2><p>Cette page est le résultat d’une conférence éclair donnée par <a href="https://twitter.com/webdevdodge" target="_blank" rel="noopener">Mike Dodge</a> à VueConf.us en mars 2018. Il a publié un utilitaire pour npm qui permettra d’échafauder rapidement un échantillon de <a href="https://fr.vuejs.org/v2/guide/single-file-components.html">Composant</a> en utilisant cette recette. Vous pouvez télécharger l’utilitaire, <a href="https://www.npmjs.com/package/vue-sfc-rollup" target="_blank" rel="noopener">vue-sfc-rollup</a>, sur npm. Vous pouvez également <a href="https://github.com/team-innovation/vue-sfc-rollup" target="_blank" rel="noopener">cloner le repo</a> et le personnaliser.</p>

  
  
  <div class="footer">
      <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<div id="bsa-native"></div>
<script>
_bsa.init('custom', 'CKYD62QM', 'placement:vuejsorg',
  {
    target: '#bsa-native',
    template: '<a class="native-box" href="##statlink##"><div class="native-sponsor">Sponsor</div><div class="native-text"><strong>##company##</strong> — ##description##</div></a>'
  }
);
</script>


    Une erreur dans cette page ou une envie de contribuer à la traduction ?
    <a href="https://github.com/vuejs-fr/vuejs.org/blob/master/src/v2/cookbook/packaging-sfc-for-npm.md" rel="noopener" target="_blank">
      Éditez cette page sur GitHub !
    </a>
  </div>
</div>

      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/search.css">
    <script src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
    [
      '#search-query-nav',
      '#search-query-sidebar',
      '#search-query-menu'
    ].forEach(function (selector) {
      if (!document.querySelector(selector)) return
      // search index defaults to v2
      var match = window.location.pathname.match(/^\/(v\d+)/)
      var version = match ? match[1] : 'v2'
      docsearch({
      appId: 'BH4D9OD16A',
      apiKey: '85cc3221c9f23bfbaa4e3913dd7625ea',
      indexName: 'vuejs',
      inputSelector: selector,
      algoliaOptions: { facetFilters: ["version:" + version] },
      autocompleteOptions: { hint: false, appendTo: 'body'}
      })
    })
    </script>
  </body>
</html>
